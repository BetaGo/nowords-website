(this["webpackJsonpnowords-website"]=this["webpackJsonpnowords-website"]||[]).push([[0],{220:function(e,t,n){},221:function(e,t,n){},241:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),o=n.n(a),i=n(16),c=n.n(i),s=(n(220),n(221),n(17)),l=n(315),u=n(316),d=n(109),j=n(314),b=n(195),f=n(13),h=n.n(f),O=n(26),p=n(164),v=n(168),m=n(135),g="AUTH_TOKEN",x="STORAGE_SETTINGS",w=("".concat(window.location.origin,"/user/login"),Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GRAPHQL_HTTP_URI:"https://portrait.gwthub.com/graphql",REACT_APP_AUTH_URL:"https://portrait.gwthub.com/auth/thirdLogin"}).REACT_APP_GRAPHQL_WS_URI,"card"),y=n(117),k=n.n(y),T=new k.a,N=n(36);function S(){var e=Object(N.a)(["\n  query User {\n    user {\n      displayName\n      id\n      email\n      avatar\n    }\n  }\n"]);return S=function(){return e},e}function C(){var e=Object(N.a)(["\n  query UserWords($first: Int!, $after: String) {\n    allUserWords(first: $first, after: $after) {\n      edges {\n        node {\n          id\n          word\n          translation\n          example\n          forgottenTimes\n          rememberTimes\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        endCursor\n      }\n      totalCount\n    }\n  }\n"]);return C=function(){return e},e}function W(){var e=Object(N.a)(["\n  query NewWords($first: Int!, $after: String) {\n    allNewWords(first: $first, after: $after) {\n      edges {\n        node {\n          id\n          word\n          translation\n          example\n          forgottenTimes\n          rememberTimes\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        endCursor\n      }\n      totalCount\n    }\n  }\n"]);return W=function(){return e},e}function E(){var e=Object(N.a)(["\n  query UserLogin($input: UserLoginInput!) {\n    userLogin(input: $input) {\n      accessToken\n      refreshToken\n    }\n  }\n"]);return E=function(){return e},e}function _(){var e=Object(N.a)(["\n  query RefreshToken($input: RefreshTokenInput!) {\n    refreshToken(input: $input) {\n      accessToken\n      refreshToken\n    }\n  }\n"]);return _=function(){return e},e}function I(){var e=Object(N.a)(["\n  query EncryptToken {\n    encryptToken {\n      token\n      publicKey\n    }\n  }\n"]);return I=function(){return e},e}var L=Object(s.gql)(I()),R=Object(s.gql)(_()),q=Object(s.gql)(E()),A=Object(s.gql)(W()),U=Object(s.gql)(C()),P=Object(s.gql)(S()),$=new s.ApolloClient({uri:"https://portrait.gwthub.com/graphql",cache:new s.InMemoryCache}),D=Object(p.a)(Object(O.a)(h.a.mark((function e(){var t,n,r,a,o,i,c,s,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(g))try{a=JSON.parse(t),n=a.accessToken,r=a.refreshToken}catch(v){console.log(v)}if(!n||!r){e.next=11;break}if(o=Math.floor(Date.now()/1e3),i=Object(m.a)(n),c=Object(m.a)(r),!(i.exp<o&&c.exp>o)){e.next=11;break}return e.next=9,$.query({query:R,variables:{input:{accessToken:n,refreshToken:r}}});case 9:s=e.sent,localStorage.setItem(g,JSON.stringify(s.data.refreshToken));case 11:return l={headers:{authorization:n?"Bearer ".concat(n):""}},e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)})))),F=Object(v.a)((function(e){var t=e.graphQLErrors,n=e.networkError,r=e.forward,a=e.operation;if(n)T.emit("notistack","\u7f51\u7edc\u6709\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",{variant:"error"});else if(t){var o=t.find((function(e){var t;return"TIPS_ERROR"===(null===(t=e.extensions)||void 0===t?void 0:t.code)}));o&&T.emit("notistack",o.message,{variant:"error"})}else T.emit("notistack","\u670d\u52a1\u5668\u51fa\u4e86\u70b9\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",{variant:"error"});return r(a)})),J=new s.ApolloClient({link:Object(s.from)([D,F,new s.HttpLink({uri:"https://portrait.gwthub.com/graphql"})]),cache:new s.InMemoryCache}),M=function(){var e=Object(d.b)().enqueueSnackbar,t=Object(a.useCallback)((function(t,n){e(t,n)}),[e]);return Object(a.useLayoutEffect)((function(){return T.addListener("notistack",t),function(){T.removeListener("notistack",t)}}),[t]),Object(r.jsx)("div",{})},V=n(14),H=n(322),B=n(119),z=n(120),K=n(77),Q=n.n(K),G={theme:"auto"},X=function(){function e(){var t=this;Object(B.a)(this,e),this._settings=G,this._EE=void 0,this._changeEventName="settingsChange",this.loadSettings=function(){var e=localStorage.getItem(x)||"";try{var n=JSON.parse(e);if(Q.a.isEqual(t._settings,n))return e;t._settings=n}catch(v){t._settings=G}return t._EE.emit(t._changeEventName,Q.a.cloneDeep(t._settings)),e},this._EE=new k.a,this.loadSettings(),window.addEventListener("storage",this.loadSettings)}return Object(z.a)(e,[{key:"get",value:function(e,t){return Q.a.get(this._settings,e,t)}},{key:"set",value:function(e,t){Q.a.set(this._settings,e,t);var n=JSON.stringify(this._settings);localStorage.setItem(x,n),this._EE.emit(this._changeEventName,Q.a.cloneDeep(this._settings))}},{key:"getAll",value:function(){return Q.a.cloneDeep(this._settings)}},{key:"addListener",value:function(e){this._EE.on(this._changeEventName,e)}},{key:"removeListener",value:function(e){this._EE.removeListener(this._changeEventName,e)}},{key:"removeAllListener",value:function(){this._EE.removeAllListeners()}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();X.instance=void 0;var Y=function(){var e=function(){var e,t=Object(a.useRef)(X.getInstance()),n=Object(a.useState)(null===(e=t.current)||void 0===e?void 0:e.getAll()),r=Object(V.a)(n,2),o=r[0],i=r[1],c=function(e){i(e)};return Object(a.useLayoutEffect)((function(){var e=t.current;return e.addListener(c),function(){return e.removeListener(c)}}),[]),{settings:o,setSetting:function(e,n){var r;null===(r=t.current)||void 0===r||r.set(e,n)}}}().settings,t=Object(H.a)("(prefers-color-scheme: dark)"),n=Object(a.useCallback)((function(){return"auto"===(null===e||void 0===e?void 0:e.theme)?t?"dark":"light":null===e||void 0===e?void 0:e.theme}),[e,t]),r=Object(a.useState)(n()),o=Object(V.a)(r,2),i=o[0],c=o[1];return Object(a.useLayoutEffect)((function(){var e=n();c(e)}),[n,t,e]),i},Z=n(72),ee=n(27),te=n(91),ne=n(52),re=n(87),ae=function(){var e=localStorage.getItem(g);if(!e)return!1;try{var t=JSON.parse(e);return t.accessToken&&t.refreshToken}catch(v){}return!1},oe=function(){var e=Object(a.useState)(ae()),t=Object(V.a)(e,2),n=t[0],r=t[1],o=function(){var e=ae();r(e)};return Object(a.useLayoutEffect)((function(){return window.addEventListener("storage",o),function(){window.removeEventListener("storage",o)}}),[]),{isLogin:n,logout:function(){localStorage.removeItem(g),J.resetStore(),window.location.reload()}}},ie=function(e){var t=e.children,n=Object(re.a)(e,["children"]),a=oe().isLogin;return console.log("isLogin",a),Object(r.jsx)(ee.b,Object(ne.a)(Object(ne.a)({},n),{},{render:function(e){var n=e.location;return a?t:Object(r.jsx)(ee.a,{to:{pathname:"/user/login",state:{from:n}}})}}))},ce=n(323),se=n(299),le=n(301),ue=n(247),de=n(245),je=n(200),be=n(300),fe=n(71),he=n(172),Oe=n.n(he),pe=n(173),ve=n.n(pe),me=n(298),ge=n(294),xe=n(295),we=n(296),ye=n(297),ke=n(321),Te=n(171),Ne=n.n(Te),Se=n(170),Ce=n.n(Se),We=Object(de.a)((function(e){return{list:{display:"flex",flexDirection:"column",justifyContent:"space-between",width:250,height:"100%"},centerList:{flex:1},large:{width:e.spacing(8),height:e.spacing(8),marginTop:e.spacing(1),marginBottom:e.spacing(1)},user:{padding:e.spacing(2),backgroundColor:e.palette.primary.main}}})),Ee=function(e){var t,n,a,o,i,c,s=We(),l=Object(ee.g)(),u=oe().logout,d=(e.toggle,e.user),j=Object(re.a)(e,["toggle","user"]);return Object(r.jsx)(ke.a,Object(ne.a)(Object(ne.a)({},j),{},{children:Object(r.jsxs)("div",{className:s.list,children:[Object(r.jsxs)("div",{className:s.user,children:[Object(r.jsx)(ce.a,{alt:"avatar",src:(null===d||void 0===d||null===(t=d.user)||void 0===t?void 0:t.avatar)||"",className:s.large,children:null===d||void 0===d||null===(n=d.user)||void 0===n||null===(a=n.displayName)||void 0===a?void 0:a[0]}),Object(r.jsx)(fe.a,{variant:"body1",children:null===d||void 0===d||null===(o=d.user)||void 0===o?void 0:o.displayName}),Object(r.jsx)(fe.a,{variant:"body2",children:null===d||void 0===d||null===(i=d.user)||void 0===i?void 0:i.email})]}),Object(r.jsx)(ge.a,{className:s.centerList,children:Object(r.jsxs)(xe.a,{button:!0,onClick:(c="/words",function(t){c&&l.push(c),e.toggle()}),children:[Object(r.jsx)(we.a,{children:Object(r.jsx)(Ce.a,{})}),Object(r.jsx)(ye.a,{children:"\u8bb0\u5355\u8bcd"})]})}),Object(r.jsx)(ge.a,{children:Object(r.jsxs)(xe.a,{button:!0,onClick:u,children:[Object(r.jsx)(we.a,{children:Object(r.jsx)(Ne.a,{})}),Object(r.jsx)(ye.a,{children:"\u9000\u51fa\u767b\u5f55"})]})})]})}))},_e=Object(de.a)((function(e){return Object(je.a)({menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}));function Ie(){var e=_e(),t=Object(me.a)(!1),n=Object(V.a)(t,2),a=n[0],o=n[1],i=Object(s.useQuery)(P),c=i.loading,l=i.data;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(se.a,{position:"static",children:Object(r.jsxs)(be.a,{children:[Object(r.jsx)(ue.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",onClick:o,children:c?Object(r.jsx)(Oe.a,{}):Object(r.jsx)(ve.a,{})}),Object(r.jsx)(fe.a,{variant:"h6",className:e.title,children:"Awesome"}),(null===l||void 0===l?void 0:l.user)?Object(r.jsx)(ce.a,{src:l.user.avatar||"",children:l.user.displayName[0]}):Object(r.jsx)(le.a,{color:"inherit",href:"/user/login",children:"Login"})]})}),Object(r.jsx)(Ee,{user:l,open:a,toggle:o,onOpen:o,onClose:o})]})}var Le=n(302),Re=n(303),qe=n(175),Ae=n.n(qe),Ue=n(174),Pe=n.n(Ue);function $e(){var e=o.a.useState(""),t=Object(V.a)(e,2),n=t[0],a=t[1],i=Object(ee.h)(),c=Object(ee.g)();return o.a.useEffect((function(){a(i.pathname)}),[i]),Object(r.jsxs)(Le.a,{value:n,onChange:function(e,t){a(t),c.push(t)},showLabels:!0,children:[Object(r.jsx)(Re.a,{value:"/words/memorize",label:"\u8bb0\u5355\u8bcd",icon:Object(r.jsx)(Pe.a,{})}),Object(r.jsx)(Re.a,{value:"/words/my-words",label:"\u6211\u7684\u5355\u8bcd",icon:Object(r.jsx)(Ae.a,{})})]})}var De=n(123),Fe=n(125),Je=n(141),Me=n(305),Ve=n(250),He=n(317),Be=n(182),ze=n.n(Be),Ke=n(319),Qe=n(32),Ge=n(196),Xe=n(304),Ye=n(53),Ze=n(181),et=function(){function e(){var t=this;Object(B.a)(this,e),this._JSEncrypt=void 0,this.rsaEncrypt=function(){var e=Object(O.a)(h.a.mark((function e(n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._JSEncrypt.setPublicKey(n),e.abrupt("return",t._JSEncrypt.encrypt(r));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this._JSEncrypt=new Ze.JSEncrypt}return Object(z.a)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();et.instance=void 0;var tt=function(e){localStorage.setItem(g,JSON.stringify(e))},nt=function(e){window.location.replace("".concat("https://portrait.gwthub.com/auth/thirdLogin","?type=").concat(e,"&redirectUrl=").concat(encodeURIComponent(window.location.origin+window.location.pathname)))},rt=Object(de.a)((function(e){return Object(je.a)({root:{width:360,margin:"auto",textAlign:"center",padding:e.spacing(2)},formItemRoot:{margin:"12px auto"},buttonFullWidth:{margin:"3px auto"},dividerRoot:{margin:"12px auto"}})})),at=Ye.a().shape({account:Ye.b().required().max(32),password:Ye.b().required().max(32)}),ot=function(){var e,t,n=Object(Qe.useForm)({resolver:Object(Fe.yupResolver)(at)}),o=n.handleSubmit,i=n.control,c=n.errors,l=rt(),u=Object(s.useLazyQuery)(q),d=Object(V.a)(u,2),j=d[0],b=d[1],f=b.loading,p=b.data,v=Object(a.useState)({show:!1,message:""}),m=Object(V.a)(v,2),g=m[0],x=m[1],w=Object(ee.g)(),y=Object(Xe.a)("accessToken"),k=Object(Xe.a)("refreshToken");Object(a.useEffect)((function(){(null===p||void 0===p?void 0:p.userLogin)&&(tt(p.userLogin),w.push("/home"))}),[p,w]),Object(a.useEffect)((function(){y&&k&&(tt({accessToken:y,refreshToken:k}),w.push("/home"))}),[y,k,w]);var T=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.query({query:L,fetchPolicy:"network-only"});case 2:if((n=e.sent).data.encryptToken){e.next=5;break}return e.abrupt("return");case 5:return r=et.getInstance(),e.next=8,r.rsaEncrypt(n.data.encryptToken.publicKey,JSON.stringify({token:n.data.encryptToken.token,text:t.password}));case 8:a=e.sent,j({variables:{input:{account:t.account,password:a}}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(Je.a,{className:l.root,children:[Object(r.jsx)(fe.a,{variant:"h6",children:"\u767b\u5f55"}),Object(r.jsxs)("form",{onSubmit:o(T),children:[Object(r.jsx)(Qe.Controller,{as:He.a,name:"account",label:"\u7528\u6237\u540d",required:!0,fullWidth:!0,variant:"outlined",control:i,defaultValue:"",rules:{required:!0},classes:{root:l.formItemRoot},error:!!c.account,helperText:null===(e=c.account)||void 0===e?void 0:e.message}),Object(r.jsx)(Qe.Controller,{as:He.a,name:"password",label:"\u5bc6\u7801",required:!0,fullWidth:!0,variant:"outlined",type:"password",control:i,defaultValue:"",rules:{required:!0},classes:{root:l.formItemRoot},error:!!c.password,helperText:null===(t=c.password)||void 0===t?void 0:t.message}),Object(r.jsx)(le.a,{type:"submit",color:"primary",variant:"contained",disableElevation:!0,fullWidth:!0,classes:{fullWidth:l.buttonFullWidth},disabled:f,children:"\u767b\u5f55"}),Object(r.jsx)(le.a,{variant:"contained",disableElevation:!0,fullWidth:!0,classes:{fullWidth:l.buttonFullWidth},onClick:function(){return w.push("/user/signup")},children:"\u6ce8\u518c"})]}),Object(r.jsx)(Me.a,{classes:{root:l.dividerRoot}}),Object(r.jsx)(fe.a,{variant:"subtitle2",children:"\u7b2c\u4e09\u65b9\u8d26\u53f7\u767b\u5f55"}),Object(r.jsxs)("div",{children:[Object(r.jsx)(ue.a,{onClick:function(){return nt("github")},children:Object(r.jsx)(ze.a,{})}),Object(r.jsx)(ue.a,{onClick:function(){return nt("weibo")},children:Object(r.jsx)(Ge.a,{})})]}),Object(r.jsx)(Ve.a,{open:g.show,onClose:function(){return x({show:!1,message:""})},autoHideDuration:3e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(r.jsx)(Ke.a,{severity:"error",children:g.message})})]})},it=Object(de.a)((function(e){return Object(je.a)({root:{marginTop:e.spacing(20)}})})),ct=function(){var e=it();return Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(De.a,{children:Object(r.jsx)("title",{children:"NO WORDS -- \u767b\u5f55"})}),Object(r.jsx)(ot,{})]})};function st(){var e=Object(N.a)(["\n  mutation UpdateNewWord($input: UpdateUserWordInput!) {\n    updateUserWord(input: $input) {\n      success\n      message\n    }\n  }\n"]);return st=function(){return e},e}function lt(){var e=Object(N.a)(["\n  mutation AddUser($input: AddUserInput!) {\n    addUser(input: $input) {\n      accessToken\n      refreshToken\n    }\n  }\n"]);return lt=function(){return e},e}function ut(){var e=Object(N.a)(["\n  mutation AddNewWord($input: AddUserWordInput!) {\n    addUserWord(input: $input) {\n      id\n    }\n  }\n"]);return ut=function(){return e},e}var dt=Object(s.gql)(ut()),jt=Object(s.gql)(lt()),bt=Object(s.gql)(st()),ft=Object(de.a)((function(e){return Object(je.a)({root:{width:360,margin:"auto",textAlign:"center",padding:e.spacing(2)},formItemRoot:{margin:"12px auto"},buttonFullWidth:{margin:"3px auto"},dividerRoot:{margin:"12px auto"}})})),ht=Ye.a().shape({username:Ye.b().required().max(32),password:Ye.b().required().max(32),displayName:Ye.b().required().max(32),email:Ye.b().email(),phone:Ye.b().max(32)}),Ot=function(){var e,t,n,o,i,c=ft(),l=Object(ee.g)(),u=Object(Qe.useForm)({resolver:Object(Fe.yupResolver)(ht)}),d=u.handleSubmit,j=u.control,b=u.errors,f=Object(s.useMutation)(jt),p=Object(V.a)(f,2),v=p[0],m=p[1],g=m.data,x=m.loading,w=Object(a.useState)({show:!1,message:""}),y=Object(V.a)(w,2),k=y[0],T=y[1];Object(a.useEffect)((function(){(null===g||void 0===g?void 0:g.addUser)&&tt(g.addUser)}),[g]);var N=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.query({query:L});case 2:if((n=e.sent).data.encryptToken){e.next=5;break}return e.abrupt("return");case 5:return r=et.getInstance(),e.next=8,r.rsaEncrypt(n.data.encryptToken.publicKey,JSON.stringify({token:n.data.encryptToken.token,text:t.password}));case 8:a=e.sent,t.password=a,v({variables:{input:t}}).then((function(e){l.replace("/")})).catch((function(e){console.log(e)}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(Je.a,{className:c.root,children:[Object(r.jsx)(fe.a,{variant:"h6",children:"\u6ce8\u518c"}),Object(r.jsxs)("form",{onSubmit:d(N),children:[Object(r.jsx)(Qe.Controller,{as:He.a,name:"username",label:"\u7528\u6237\u540d",required:!0,fullWidth:!0,variant:"outlined",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.username,helperText:null===(e=b.username)||void 0===e?void 0:e.message}),Object(r.jsx)(Qe.Controller,{as:He.a,name:"displayName",label:"\u6635\u79f0",required:!0,fullWidth:!0,variant:"outlined",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.displayName,helperText:null===(t=b.displayName)||void 0===t?void 0:t.message}),Object(r.jsx)(Qe.Controller,{as:He.a,name:"password",label:"\u5bc6\u7801",required:!0,fullWidth:!0,variant:"outlined",type:"password",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.password,helperText:null===(n=b.password)||void 0===n?void 0:n.message}),Object(r.jsx)(Qe.Controller,{as:He.a,name:"email",label:"\u90ae\u7bb1",fullWidth:!0,variant:"outlined",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.email,helperText:null===(o=b.email)||void 0===o?void 0:o.message}),Object(r.jsx)(Qe.Controller,{as:He.a,name:"phone",label:"\u624b\u673a\u53f7",fullWidth:!0,variant:"outlined",control:j,defaultValue:"",classes:{root:c.formItemRoot},error:!!b.phone,helperText:null===(i=b.phone)||void 0===i?void 0:i.message}),Object(r.jsx)(le.a,{type:"submit",variant:"contained",color:"primary",disableElevation:!0,fullWidth:!0,classes:{fullWidth:c.buttonFullWidth},disabled:x,children:"\u6ce8\u518c"}),Object(r.jsx)(le.a,{type:"submit",variant:"contained",disableElevation:!0,fullWidth:!0,classes:{fullWidth:c.buttonFullWidth},onClick:function(){return l.push("/user/login")},children:"\u5df2\u6709\u8d26\u53f7\uff1f\u70b9\u6b64\u767b\u5f55"})]}),Object(r.jsx)(Ve.a,{open:k.show,onClose:function(){return T({show:!1,message:""})},autoHideDuration:3e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(r.jsx)(Ke.a,{severity:"error",children:k.message})})]})},pt=Object(de.a)((function(e){return Object(je.a)({root:{marginTop:e.spacing(20)}})})),vt=function(){var e=pt();return Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(De.a,{children:Object(r.jsx)("title",{children:"NO WORDS -- \u6ce8\u518c"})}),Object(r.jsx)(Ot,{})]})},mt=n(28),gt=n(309),xt=n(190),wt=n.n(xt),yt=n(189),kt=n.n(yt),Tt=n(306),Nt=n(308),St=n(307),Ct=n(318),Wt=n(184),Et=n.n(Wt),_t=n(183),It=n.n(_t),Lt=Object(de.a)((function(e){return Object(je.a)({icon:{textAlign:"center"}})})),Rt=function(e){var t=Lt(),n=Object(me.a)(!1),a=Object(V.a)(n,2),o=a[0],i=a[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:t.icon,children:o?Object(r.jsx)(It.a,{onClick:i}):Object(r.jsx)(Et.a,{onClick:i})}),o?Object(r.jsx)(fe.a,{variant:"body2",children:e.children}):null]})},qt=Object(de.a)((function(e){return Object(je.a)({card:{margin:"auto",overflow:"auto",height:"40vh",width:"75vw"}})})),At=function(e){var t=e.data.node,n=qt(),a=Object(Ct.a)({item:{type:w,id:t.id},collect:function(e){var n=e.getInitialClientOffset(),r=e.getClientOffset(),a=e.getItem(),o=a&&a.id===t.id;return{isDragging:!!e.isDragging(),offset:{x:o&&r&&n?(null===r||void 0===r?void 0:r.x)-(null===n||void 0===n?void 0:n.x):0,y:o&&r&&n?(null===r||void 0===r?void 0:r.y)-(null===n||void 0===n?void 0:n.y):0}}},end:function(n,r){var a=r.getInitialClientOffset(),o=r.getClientOffset(),i=r.getItem(),c=i&&i.id===t.id,s=o&&a?(null===o||void 0===o?void 0:o.x)-(null===a||void 0===a?void 0:a.x):0;c&&s>100&&e.onSlideRight&&e.onSlideRight(e.data),c&&s<-100&&e.onSlideLeft&&e.onSlideLeft(e.data)}}),o=Object(V.a)(a,2),i=o[0].offset,c=o[1];return Object(r.jsx)("div",{ref:c,style:{transform:"translate(".concat(i.x,"px, ").concat(i.y,"px)")},children:Object(r.jsxs)(Tt.a,{className:n.card,children:[Object(r.jsx)(St.a,{title:t.word}),Object(r.jsx)(Nt.a,{children:Object(r.jsx)(fe.a,{variant:"body2",children:t.example})}),Object(r.jsx)(Nt.a,{children:Object(r.jsx)(Rt,{children:t.translation})})]})})};function Ut(){var e=Object(N.a)(["\n  position: relative;\n  margin: 20px auto 30px;\n  height: 40vh;\n  width: 75vw;\n"]);return Ut=function(){return e},e}function Pt(){var e=Object(N.a)(["\n  position: absolute;\n  width: 100%;\n  top: 0;\n  left: 0;\n  transform: ",";\n"]);return Pt=function(){return e},e}var $t=te.a.div(Pt(),(function(e){return"perspective(500px) translate3d(0,"+10*Math.min(e.index,2)+"px,"+-20*Math.min(e.index,2)+"px)"})),Dt=te.a.div(Ut()),Ft=function(e){return Object(r.jsx)(Dt,{children:e.list.map((function(t,n){return Object(r.jsx)($t,{index:n,children:Object(r.jsx)(At,{data:t,onSlideLeft:e.onSlideLeft,onSlideRight:e.onSlideRight})},t.node.id)})).reverse()})},Jt=Object(de.a)((function(e){return Object(je.a)({root:{display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center",flex:1},content:{display:"flex",flexDirection:"column"},noWords:{margin:"auto",padding:e.spacing(2),textAlign:"center"},action:{display:"flex",justifyContent:"space-evenly",alignContent:"center"}})})),Mt=function(){var e=Jt(),t=o.a.useState(0),n=Object(V.a)(t,2),a=n[0],i=n[1],c=Object(s.useQuery)(A,{variables:{first:4}}),l=c.data,u=c.loading,d=c.fetchMore,j=c.refetch,b=Object(s.useMutation)(bt),f=Object(V.a)(b,1)[0],p=function(){var e=Object(O.a)(h.a.mark((function e(t,n){var r,o,c,s,u,j,b,O;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n||(null===l||void 0===l||null===(r=l.allNewWords)||void 0===r||null===(o=r.edges)||void 0===o?void 0:o[a])){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,f({variables:{input:{id:u.node.id,forgottenTimes:"forgotten"===t?u.node.forgottenTimes+1:u.node.forgottenTimes,rememberTimes:"remember"===t?u.node.rememberTimes+1:u.node.rememberTimes}}});case 5:j=e.sent,(null===(c=j.data)||void 0===c||null===(s=c.updateUserWord)||void 0===s?void 0:s.success)&&(i((function(e){return e+1})),(null===(O=null===l||void 0===l||null===(b=l.allNewWords)||void 0===b?void 0:b.pageInfo)||void 0===O?void 0:O.hasNextPage)&&(h={first:1,after:O.endCursor},d({variables:h,updateQuery:function(e,t){var n=t.fetchMoreResult;if(!n||!n.allNewWords)return e;var r=n.allNewWords.edges,a=n.allNewWords.pageInfo,o=n.allNewWords.totalCount,i={allNewWords:{__typename:e.allNewWords.__typename,edges:[].concat(Object(mt.a)(e.allNewWords.edges),Object(mt.a)(r)),pageInfo:a,totalCount:o}};return r&&r.length?i:e}})));case 7:case"end":return e.stop()}var h}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j({first:4,after:void 0});case 2:i(0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{className:e.root,children:Object(r.jsx)("div",{className:e.content,children:function(){var t,n,o,i,c,s,d;return!(null===l||void 0===l||null===(t=l.allNewWords)||void 0===t||null===(n=t.edges)||void 0===n?void 0:n.length)&&u?Object(r.jsx)(Je.a,{elevation:0,className:e.noWords,children:Object(r.jsx)(fe.a,{variant:"body2",children:"Loading..."})}):0===(null===l||void 0===l||null===(o=l.allNewWords)||void 0===o?void 0:o.totalCount)?Object(r.jsx)(Je.a,{elevation:0,className:e.noWords,children:Object(r.jsx)(fe.a,{variant:"body2",children:"\u6ca1\u6709\u65b0\u7684\u5355\u8bcd\u4e86~"})}):(null===l||void 0===l||null===(i=l.allNewWords)||void 0===i||null===(c=i.edges)||void 0===c?void 0:c.length)&&(null===l||void 0===l||null===(s=l.allNewWords)||void 0===s?void 0:s.edges.length)>a?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ft,{list:null===l||void 0===l||null===(d=l.allNewWords)||void 0===d?void 0:d.edges.slice(a,a+4),onSlideLeft:function(e){return p("forgotten",e)},onSlideRight:function(e){return p("remember",e)}}),Object(r.jsxs)("div",{className:e.action,children:[Object(r.jsx)(gt.a,{color:"secondary","aria-label":"forgotten",onClick:function(){return p("forgotten")},children:Object(r.jsx)(kt.a,{})}),Object(r.jsx)(gt.a,{color:"primary","aria-label":"remember",onClick:function(){return p("remember")},children:Object(r.jsx)(wt.a,{})})]})]}):Object(r.jsxs)(Je.a,{elevation:0,className:e.noWords,children:[Object(r.jsx)(fe.a,{variant:"body2",children:"\u606d\u559c\u5b8c\u6210\u6240\u6709\u5355\u8bcd"}),Object(r.jsx)(le.a,{variant:"outlined",color:"secondary",onClick:v,children:"\u518d\u6765\u4e00\u904d"})]})}()})})},Vt=n(320),Ht=n(324),Bt=n(313),zt=n(312),Kt=n(243),Qt=n(193),Gt=n.n(Qt),Xt=n(192),Yt=n.n(Xt),Zt=n(127),en=n(246),tn=n(311),nn=n(310),rn=n(191),an=n.n(rn),on=Object(de.a)((function(e){return Object(je.a)({root:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},content:{"& > *":{marginTop:e.spacing(2)},flex:1,margin:e.spacing(2),overflow:"auto"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})})),cn=function(e){var t=e.onManualClose,n=Object(re.a)(e,["onManualClose"]),a=on(),i=Object(Qe.useForm)({mode:"onChange"}),c=i.control,l=i.handleSubmit,u=i.errors,d=Object(s.useMutation)(dt),j=Object(V.a)(d,1)[0],b=o.a.useState(!1),f=Object(V.a)(b,2),p=f[0],v=f[1],m=function(){var e=Object(O.a)(h.a.mark((function e(n){var r,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.next=3,j({variables:{input:n}});case 3:o=e.sent,v(!1),(null===(r=o.data)||void 0===r||null===(a=r.addUserWord)||void 0===a?void 0:a.id)&&t();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return console.log("errors:",u),Object(r.jsxs)(nn.a,Object(ne.a)(Object(ne.a)({},n),{},{children:[Object(r.jsxs)("form",{className:a.root,onSubmit:l(m),noValidate:!0,autoComplete:"off",children:[Object(r.jsx)(se.a,{className:a.appBar,children:Object(r.jsxs)(be.a,{children:[Object(r.jsx)(ue.a,{edge:"start",color:"inherit","aria-label":"close",onClick:function(){t()},children:Object(r.jsx)(an.a,{})}),Object(r.jsx)(fe.a,{variant:"h6",className:a.title,children:"\u6dfb\u52a0\u751f\u8bcd"}),Object(r.jsx)(le.a,{disabled:p,autoFocus:!0,color:"inherit",type:"submit",children:"\u4fdd\u5b58"})]})}),Object(r.jsxs)("div",{className:a.content,children:[Object(r.jsx)(Qe.Controller,{control:c,as:Object(r.jsx)(He.a,{error:!!u.word,fullWidth:!0,label:"\u751f\u8bcd",placeholder:"\u8bf7\u8f93\u5165\u751f\u8bcd",variant:"outlined",helperText:Object(r.jsx)(Zt.a,{errors:u,name:"word"})}),name:"word",rules:{required:{value:!0,message:"\u5fc5\u586b"},maxLength:{value:32,message:"\u5355\u8bcd\u8fc7\u957f"}},defaultValue:""}),Object(r.jsx)(Qe.Controller,{control:c,as:Object(r.jsx)(He.a,{fullWidth:!0,label:"\u7ffb\u8bd1",placeholder:"\u8bf7\u8f93\u5165\u7ffb\u8bd1\uff08\u53ef\u4e0d\u586b\uff09",variant:"outlined",helperText:Object(r.jsx)(Zt.a,{errors:u,name:"translation"})}),name:"translation",rules:{maxLength:{value:512,message:"\u7ffb\u8bd1\u8fc7\u957f"}},multiline:!0,rows:"4",defaultValue:""}),Object(r.jsx)(Qe.Controller,{control:c,as:Object(r.jsx)(He.a,{fullWidth:!0,label:"\u4f8b\u53e5",placeholder:"\u8bf7\u8f93\u5165\u4f8b\u53e5\uff08\u53ef\u4e0d\u586b\uff09",variant:"outlined",helperText:Object(r.jsx)(Zt.a,{errors:u,name:"example"})}),name:"example",rules:{maxLength:{value:512,message:"\u4f8b\u53e5\u8fc7\u957f"}},multiline:!0,rows:"4",defaultValue:""})]})]}),Object(r.jsx)(en.a,{className:a.backdrop,open:p,children:Object(r.jsx)(tn.a,{color:"inherit"})})]}))},sn=o.a.forwardRef((function(e,t){return Object(r.jsx)(Kt.a,Object(ne.a)({direction:"up",ref:t},e))})),ln=Object(de.a)((function(e){return Object(je.a)({root:{width:"100%",backgroundColor:e.palette.background.paper,paddingBottom:e.spacing(8),overflow:"auto"},actions:{position:"fixed",bottom:e.spacing(10),right:e.spacing(3)}})})),un=function(){var e,t,n=ln(),a=o.a.useState(!1),i=Object(V.a)(a,2),c=i[0],l=i[1],u=Object(s.useQuery)(U,{variables:{first:20}}).data,d=function(){l(!1)};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ge.a,{className:n.root,children:null===u||void 0===u||null===(e=u.allUserWords)||void 0===e||null===(t=e.edges)||void 0===t?void 0:t.map((function(e){return Object(r.jsxs)(Ht.a,{children:[Object(r.jsx)(zt.a,{expandIcon:Object(r.jsx)(Yt.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(r.jsxs)(xe.a,{children:[Object(r.jsx)(we.a,{children:Object(r.jsx)(Vt.a,{edge:"start",tabIndex:-1,disableRipple:!0,onClick:function(e){return e.stopPropagation()}})}),Object(r.jsx)(ye.a,{children:Object(r.jsx)(fe.a,{children:e.node.word})})]})}),Object(r.jsxs)(Bt.a,{children:[Object(r.jsx)(fe.a,{children:e.node.example}),Object(r.jsx)(fe.a,{children:e.node.translation})]})]},e.node.id)}))}),Object(r.jsx)(gt.a,{className:n.actions,color:"primary","aria-label":"remember",onClick:function(){l(!0)},children:Object(r.jsx)(Gt.a,{})}),Object(r.jsx)(cn,{open:c,fullScreen:!0,onClose:d,onManualClose:d,TransitionComponent:sn})]})};function dn(){var e=Object(N.a)(["\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  width: 100%;\n  height: 100%;\n"]);return dn=function(){return e},e}function jn(){var e=Object(N.a)(["\n  display: flex;\n  flex: 1;\n  overflow: auto;\n"]);return jn=function(){return e},e}var bn=te.a.div(jn()),fn=te.a.div(dn()),hn=function(){return Object(r.jsx)(Z.a,{children:Object(r.jsxs)(ee.d,{children:[Object(r.jsx)(ee.b,{path:"/user/login",exact:!0,component:ct}),Object(r.jsx)(ee.b,{path:"/user/signup",component:vt}),Object(r.jsx)(ie,{path:"/",children:Object(r.jsxs)(fn,{children:[Object(r.jsx)(Ie,{}),Object(r.jsxs)(ee.b,{path:"/words",children:[Object(r.jsx)(bn,{children:Object(r.jsxs)(ee.d,{children:[Object(r.jsx)(ee.b,{path:"/words/memorize",component:Mt}),Object(r.jsx)(ee.b,{path:"/words/my-words",component:un}),Object(r.jsx)(ee.b,{path:"/words/statistics",children:"statistics"}),Object(r.jsx)(ee.a,{to:"/words/memorize"})]})}),Object(r.jsx)($e,{})]})]})})]})})},On=n(194),pn=Object(On.a)({palette:{secondary:{main:"#127bc4",light:"rgb(65, 149, 207)",dark:"rgb(12, 86, 137)",contrastText:"#fff"},type:"dark",background:{default:"#121212"},primary:{main:"#d63947",light:"rgb(222, 96, 107)",dark:"rgb(149, 39, 49)",contrastText:"#fff"}}}),vn=Object(On.a)({palette:{secondary:{main:"#127bc4",light:"rgb(65, 149, 207)",dark:"rgb(12, 86, 137)",contrastText:"#fff"},type:"light",background:{default:"#fff"},primary:{main:"#d63947",light:"rgb(222, 96, 107)",dark:"rgb(149, 39, 49)",contrastText:"#fff"}}});var mn=function(){var e=Y();return console.log("thememod",e),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(s.ApolloProvider,{client:J,children:Object(r.jsx)(j.a,{backend:b.a,children:Object(r.jsx)(l.a,{theme:"dark"===e?pn:vn,children:Object(r.jsxs)(d.a,{children:[Object(r.jsx)(u.a,{}),Object(r.jsx)(hn,{}),Object(r.jsx)(M,{})]})})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(mn,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[241,1,2]]]);
//# sourceMappingURL=main.3a6ceeb1.chunk.js.map