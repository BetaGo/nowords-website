(this["webpackJsonpnowords-website"]=this["webpackJsonpnowords-website"]||[]).push([[0],{219:function(e,t,n){},220:function(e,t,n){},240:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),o=n.n(a),i=n(16),c=n.n(i),s=(n(219),n(220),n(17)),l=n(314),u=n(315),d=n(109),j=n(313),b=n(194),f=n(13),h=n.n(f),O=n(26),p=n(164),v=n(168),m=n(135),g="AUTH_TOKEN",x="STORAGE_SETTINGS",w=n(117),y=n.n(w),k=new y.a,T=n(36);function N(){var e=Object(T.a)(["\n  query User {\n    user {\n      displayName\n      id\n      email\n      avatar\n    }\n  }\n"]);return N=function(){return e},e}function S(){var e=Object(T.a)(["\n  query UserWords($first: Int!, $after: String) {\n    allUserWords(first: $first, after: $after) {\n      edges {\n        node {\n          id\n          word\n          translation\n          example\n          forgottenTimes\n          rememberTimes\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        endCursor\n      }\n      totalCount\n    }\n  }\n"]);return S=function(){return e},e}function C(){var e=Object(T.a)(["\n  query NewWords($first: Int!, $after: String) {\n    allNewWords(first: $first, after: $after) {\n      edges {\n        node {\n          id\n          word\n          translation\n          example\n          forgottenTimes\n          rememberTimes\n        }\n        cursor\n      }\n      pageInfo {\n        hasNextPage\n        endCursor\n      }\n      totalCount\n    }\n  }\n"]);return C=function(){return e},e}function W(){var e=Object(T.a)(["\n  query UserLogin($input: UserLoginInput!) {\n    userLogin(input: $input) {\n      accessToken\n      refreshToken\n    }\n  }\n"]);return W=function(){return e},e}function E(){var e=Object(T.a)(["\n  query RefreshToken($input: RefreshTokenInput!) {\n    refreshToken(input: $input) {\n      accessToken\n      refreshToken\n    }\n  }\n"]);return E=function(){return e},e}function _(){var e=Object(T.a)(["\n  query EncryptToken {\n    encryptToken {\n      token\n      publicKey\n    }\n  }\n"]);return _=function(){return e},e}var I=Object(s.gql)(_()),R=Object(s.gql)(E()),L=Object(s.gql)(W()),q=Object(s.gql)(C()),A=Object(s.gql)(S()),U=Object(s.gql)(N()),P=new s.ApolloClient({uri:"https://portrait.gwthub.com/graphql",cache:new s.InMemoryCache}),$=Object(p.a)(Object(O.a)(h.a.mark((function e(){var t,n,r,a,o,i,c,s,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(g))try{a=JSON.parse(t),n=a.accessToken,r=a.refreshToken}catch(v){console.log(v)}if(!n||!r){e.next=11;break}if(o=Math.floor(Date.now()/1e3),i=Object(m.a)(n),c=Object(m.a)(r),!(i.exp<o&&c.exp>o)){e.next=11;break}return e.next=9,P.query({query:R,variables:{input:{accessToken:n,refreshToken:r}}});case 9:s=e.sent,localStorage.setItem(g,JSON.stringify(s.data.refreshToken));case 11:return l={headers:{authorization:n?"Bearer ".concat(n):""}},e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)})))),D=Object(v.a)((function(e){var t=e.graphQLErrors,n=e.networkError,r=e.forward,a=e.operation;if(n)k.emit("notistack","\u7f51\u7edc\u6709\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",{variant:"error"});else if(t){var o=t.find((function(e){var t;return"TIPS_ERROR"===(null===(t=e.extensions)||void 0===t?void 0:t.code)}));o&&k.emit("notistack",o.message,{variant:"error"})}else k.emit("notistack","\u670d\u52a1\u5668\u51fa\u4e86\u70b9\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",{variant:"error"});return r(a)})),F=new s.ApolloClient({link:Object(s.from)([$,D,new s.HttpLink({uri:"https://portrait.gwthub.com/graphql"})]),cache:new s.InMemoryCache}),J=function(){var e=Object(d.b)().enqueueSnackbar,t=Object(a.useCallback)((function(t,n){e(t,n)}),[e]);return Object(a.useLayoutEffect)((function(){return k.addListener("notistack",t),function(){k.removeListener("notistack",t)}}),[t]),Object(r.jsx)("div",{})},M=n(14),V=n(321),H=n(119),B=n(120),z=n(77),K=n.n(z),Q={theme:"auto"},G=function(){function e(){var t=this;Object(H.a)(this,e),this._settings=Q,this._EE=void 0,this._changeEventName="settingsChange",this.loadSettings=function(){var e=localStorage.getItem(x)||"";try{var n=JSON.parse(e);if(K.a.isEqual(t._settings,n))return e;t._settings=n}catch(v){t._settings=Q}return t._EE.emit(t._changeEventName,K.a.cloneDeep(t._settings)),e},this._EE=new y.a,this.loadSettings(),window.addEventListener("storage",this.loadSettings)}return Object(B.a)(e,[{key:"get",value:function(e,t){return K.a.get(this._settings,e,t)}},{key:"set",value:function(e,t){K.a.set(this._settings,e,t);var n=JSON.stringify(this._settings);localStorage.setItem(x,n),this._EE.emit(this._changeEventName,K.a.cloneDeep(this._settings))}},{key:"getAll",value:function(){return K.a.cloneDeep(this._settings)}},{key:"addListener",value:function(e){this._EE.on(this._changeEventName,e)}},{key:"removeListener",value:function(e){this._EE.removeListener(this._changeEventName,e)}},{key:"removeAllListener",value:function(){this._EE.removeAllListeners()}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();G.instance=void 0;var X=function(){var e=function(){var e,t=Object(a.useRef)(G.getInstance()),n=Object(a.useState)(null===(e=t.current)||void 0===e?void 0:e.getAll()),r=Object(M.a)(n,2),o=r[0],i=r[1],c=function(e){i(e)};return Object(a.useLayoutEffect)((function(){var e=t.current;return e.addListener(c),function(){return e.removeListener(c)}}),[]),{settings:o,setSetting:function(e,n){var r;null===(r=t.current)||void 0===r||r.set(e,n)}}}().settings,t=Object(V.a)("(prefers-color-scheme: dark)"),n=Object(a.useCallback)((function(){return"auto"===(null===e||void 0===e?void 0:e.theme)?t?"dark":"light":null===e||void 0===e?void 0:e.theme}),[e,t]),r=Object(a.useState)(n()),o=Object(M.a)(r,2),i=o[0],c=o[1];return Object(a.useLayoutEffect)((function(){var e=n();c(e)}),[n,t,e]),i},Y=n(72),Z=n(27),ee=n(91),te=n(52),ne=n(87),re=function(){var e=localStorage.getItem(g);if(!e)return!1;try{var t=JSON.parse(e);return t.accessToken&&t.refreshToken}catch(v){}return!1},ae=function(e){var t=e.children,n=Object(ne.a)(e,["children"]),o=function(){var e=Object(a.useState)(re()),t=Object(M.a)(e,2),n=t[0],r=t[1],o=function(){var e=re();r(e)};return Object(a.useLayoutEffect)((function(){return window.addEventListener("storage",o),function(){window.removeEventListener("storage",o)}}),[]),n}();return console.log("isLogin",o),Object(r.jsx)(Z.b,Object(te.a)(Object(te.a)({},n),{},{render:function(e){var n=e.location;return o?t:Object(r.jsx)(Z.a,{to:{pathname:"/user/login",state:{from:n}}})}}))},oe=n(322),ie=n(298),ce=n(300),se=n(246),le=n(244),ue=n(199),de=n(299),je=n(71),be=n(171),fe=n.n(be),he=n(172),Oe=n.n(he),pe=n(297),ve=n(293),me=n(294),ge=n(295),xe=n(296),we=n(320),ye=n(170),ke=n.n(ye),Te=Object(le.a)((function(e){return{list:{width:250},large:{width:e.spacing(8),height:e.spacing(8),marginTop:e.spacing(1),marginBottom:e.spacing(1)},user:{padding:e.spacing(2),backgroundColor:e.palette.primary.main}}})),Ne=function(e){var t,n,a,o,i,c,s=Te(),l=Object(Z.g)(),u=(e.toggle,e.user),d=Object(ne.a)(e,["toggle","user"]);return Object(r.jsx)(we.a,Object(te.a)(Object(te.a)({},d),{},{children:Object(r.jsxs)("div",{className:s.list,children:[Object(r.jsxs)("div",{className:s.user,children:[Object(r.jsx)(oe.a,{alt:"avatar",src:(null===u||void 0===u||null===(t=u.user)||void 0===t?void 0:t.avatar)||"",className:s.large,children:null===u||void 0===u||null===(n=u.user)||void 0===n||null===(a=n.displayName)||void 0===a?void 0:a[0]}),Object(r.jsx)(je.a,{variant:"body1",children:null===u||void 0===u||null===(o=u.user)||void 0===o?void 0:o.displayName}),Object(r.jsx)(je.a,{variant:"body2",children:null===u||void 0===u||null===(i=u.user)||void 0===i?void 0:i.email})]}),Object(r.jsx)(ve.a,{children:Object(r.jsxs)(me.a,{button:!0,onClick:(c="/words",function(t){c&&l.push(c),e.toggle()}),children:[Object(r.jsx)(ge.a,{children:Object(r.jsx)(ke.a,{})}),Object(r.jsx)(xe.a,{children:"\u8bb0\u5355\u8bcd"})]})})]})}))},Se=Object(le.a)((function(e){return Object(ue.a)({menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}));function Ce(){var e=Se(),t=Object(pe.a)(!1),n=Object(M.a)(t,2),a=n[0],o=n[1],i=Object(s.useQuery)(U),c=i.loading,l=i.data;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ie.a,{position:"static",children:Object(r.jsxs)(de.a,{children:[Object(r.jsx)(se.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",onClick:o,children:c?Object(r.jsx)(fe.a,{}):Object(r.jsx)(Oe.a,{})}),Object(r.jsx)(je.a,{variant:"h6",className:e.title,children:"Awesome"}),(null===l||void 0===l?void 0:l.user)?Object(r.jsx)(oe.a,{src:l.user.avatar||"",children:l.user.displayName[0]}):Object(r.jsx)(ce.a,{color:"inherit",href:"/user/login",children:"Login"})]})}),Object(r.jsx)(Ne,{user:l,open:a,toggle:o,onOpen:o,onClose:o})]})}var We=n(301),Ee=n(302),_e=n(174),Ie=n.n(_e),Re=n(173),Le=n.n(Re);function qe(){var e=o.a.useState(""),t=Object(M.a)(e,2),n=t[0],a=t[1],i=Object(Z.h)(),c=Object(Z.g)();return o.a.useEffect((function(){a(i.pathname)}),[i]),Object(r.jsxs)(We.a,{value:n,onChange:function(e,t){a(t),c.push(t)},showLabels:!0,children:[Object(r.jsx)(Ee.a,{value:"/words/memorize",label:"\u8bb0\u5355\u8bcd",icon:Object(r.jsx)(Le.a,{})}),Object(r.jsx)(Ee.a,{value:"/words/my-words",label:"\u6211\u7684\u5355\u8bcd",icon:Object(r.jsx)(Ie.a,{})})]})}var Ae=n(123),Ue=n(125),Pe=n(141),$e=n(304),De=n(249),Fe=n(316),Je=n(181),Me=n.n(Je),Ve=n(318),He=n(32),Be=n(195),ze=n(303),Ke=n(53),Qe=n(180),Ge=function(){function e(){var t=this;Object(H.a)(this,e),this._JSEncrypt=void 0,this.rsaEncrypt=function(){var e=Object(O.a)(h.a.mark((function e(n,r){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._JSEncrypt.setPublicKey(n),e.abrupt("return",t._JSEncrypt.encrypt(r));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this._JSEncrypt=new Qe.JSEncrypt}return Object(B.a)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();Ge.instance=void 0;var Xe=function(e){localStorage.setItem(g,JSON.stringify(e))},Ye=function(e){window.location.replace("".concat("https://portrait.gwthub.com/auth/thirdLogin","?type=").concat(e,"&redirectUrl=").concat(encodeURIComponent(window.location.origin+window.location.pathname)))},Ze=Object(le.a)((function(e){return Object(ue.a)({root:{width:360,margin:"auto",textAlign:"center",padding:e.spacing(2)},formItemRoot:{margin:"12px auto"},buttonFullWidth:{margin:"3px auto"},dividerRoot:{margin:"12px auto"}})})),et=Ke.a().shape({account:Ke.b().required().max(32),password:Ke.b().required().max(32)}),tt=function(){var e,t,n=Object(He.useForm)({resolver:Object(Ue.yupResolver)(et)}),o=n.handleSubmit,i=n.control,c=n.errors,l=Ze(),u=Object(s.useLazyQuery)(L),d=Object(M.a)(u,2),j=d[0],b=d[1],f=b.loading,p=b.data,v=Object(a.useState)({show:!1,message:""}),m=Object(M.a)(v,2),g=m[0],x=m[1],w=Object(Z.g)(),y=Object(ze.a)("accessToken"),k=Object(ze.a)("refreshToken");Object(a.useEffect)((function(){(null===p||void 0===p?void 0:p.userLogin)&&(Xe(p.userLogin),w.push("/home"))}),[p,w]),Object(a.useEffect)((function(){y&&k&&(Xe({accessToken:y,refreshToken:k}),w.push("/home"))}),[y,k,w]);var T=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.query({query:I,fetchPolicy:"network-only"});case 2:if((n=e.sent).data.encryptToken){e.next=5;break}return e.abrupt("return");case 5:return r=Ge.getInstance(),e.next=8,r.rsaEncrypt(n.data.encryptToken.publicKey,JSON.stringify({token:n.data.encryptToken.token,text:t.password}));case 8:a=e.sent,j({variables:{input:{account:t.account,password:a}}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(Pe.a,{className:l.root,children:[Object(r.jsx)(je.a,{variant:"h6",children:"\u767b\u5f55"}),Object(r.jsxs)("form",{onSubmit:o(T),children:[Object(r.jsx)(He.Controller,{as:Fe.a,name:"account",label:"\u7528\u6237\u540d",required:!0,fullWidth:!0,variant:"outlined",control:i,defaultValue:"",rules:{required:!0},classes:{root:l.formItemRoot},error:!!c.account,helperText:null===(e=c.account)||void 0===e?void 0:e.message}),Object(r.jsx)(He.Controller,{as:Fe.a,name:"password",label:"\u5bc6\u7801",required:!0,fullWidth:!0,variant:"outlined",type:"password",control:i,defaultValue:"",rules:{required:!0},classes:{root:l.formItemRoot},error:!!c.password,helperText:null===(t=c.password)||void 0===t?void 0:t.message}),Object(r.jsx)(ce.a,{type:"submit",color:"primary",variant:"contained",disableElevation:!0,fullWidth:!0,classes:{fullWidth:l.buttonFullWidth},disabled:f,children:"\u767b\u5f55"}),Object(r.jsx)(ce.a,{variant:"contained",disableElevation:!0,fullWidth:!0,classes:{fullWidth:l.buttonFullWidth},onClick:function(){return w.push("/user/signup")},children:"\u6ce8\u518c"})]}),Object(r.jsx)($e.a,{classes:{root:l.dividerRoot}}),Object(r.jsx)(je.a,{variant:"subtitle2",children:"\u7b2c\u4e09\u65b9\u8d26\u53f7\u767b\u5f55"}),Object(r.jsxs)("div",{children:[Object(r.jsx)(se.a,{onClick:function(){return Ye("github")},children:Object(r.jsx)(Me.a,{})}),Object(r.jsx)(se.a,{onClick:function(){return Ye("weibo")},children:Object(r.jsx)(Be.a,{})})]}),Object(r.jsx)(De.a,{open:g.show,onClose:function(){return x({show:!1,message:""})},autoHideDuration:3e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(r.jsx)(Ve.a,{severity:"error",children:g.message})})]})},nt=Object(le.a)((function(e){return Object(ue.a)({root:{marginTop:e.spacing(20)}})})),rt=function(){var e=nt();return Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(Ae.a,{children:Object(r.jsx)("title",{children:"NO WORDS -- \u767b\u5f55"})}),Object(r.jsx)(tt,{})]})};function at(){var e=Object(T.a)(["\n  mutation UpdateNewWord($input: UpdateUserWordInput!) {\n    updateUserWord(input: $input) {\n      success\n      message\n    }\n  }\n"]);return at=function(){return e},e}function ot(){var e=Object(T.a)(["\n  mutation AddUser($input: AddUserInput!) {\n    addUser(input: $input) {\n      accessToken\n      refreshToken\n    }\n  }\n"]);return ot=function(){return e},e}function it(){var e=Object(T.a)(["\n  mutation AddNewWord($input: AddUserWordInput!) {\n    addUserWord(input: $input) {\n      id\n    }\n  }\n"]);return it=function(){return e},e}var ct=Object(s.gql)(it()),st=Object(s.gql)(ot()),lt=Object(s.gql)(at()),ut=Object(le.a)((function(e){return Object(ue.a)({root:{width:360,margin:"auto",textAlign:"center",padding:e.spacing(2)},formItemRoot:{margin:"12px auto"},buttonFullWidth:{margin:"3px auto"},dividerRoot:{margin:"12px auto"}})})),dt=Ke.a().shape({username:Ke.b().required().max(32),password:Ke.b().required().max(32),displayName:Ke.b().required().max(32),email:Ke.b().email(),phone:Ke.b().max(32)}),jt=function(){var e,t,n,o,i,c=ut(),l=Object(Z.g)(),u=Object(He.useForm)({resolver:Object(Ue.yupResolver)(dt)}),d=u.handleSubmit,j=u.control,b=u.errors,f=Object(s.useMutation)(st),p=Object(M.a)(f,2),v=p[0],m=p[1],g=m.data,x=m.loading,w=Object(a.useState)({show:!1,message:""}),y=Object(M.a)(w,2),k=y[0],T=y[1];Object(a.useEffect)((function(){(null===g||void 0===g?void 0:g.addUser)&&Xe(g.addUser)}),[g]);var N=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.query({query:I});case 2:if((n=e.sent).data.encryptToken){e.next=5;break}return e.abrupt("return");case 5:return r=Ge.getInstance(),e.next=8,r.rsaEncrypt(n.data.encryptToken.publicKey,JSON.stringify({token:n.data.encryptToken.token,text:t.password}));case 8:a=e.sent,t.password=a,v({variables:{input:t}}).then((function(e){l.replace("/")})).catch((function(e){console.log(e)}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)(Pe.a,{className:c.root,children:[Object(r.jsx)(je.a,{variant:"h6",children:"\u6ce8\u518c"}),Object(r.jsxs)("form",{onSubmit:d(N),children:[Object(r.jsx)(He.Controller,{as:Fe.a,name:"username",label:"\u7528\u6237\u540d",required:!0,fullWidth:!0,variant:"outlined",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.username,helperText:null===(e=b.username)||void 0===e?void 0:e.message}),Object(r.jsx)(He.Controller,{as:Fe.a,name:"displayName",label:"\u6635\u79f0",required:!0,fullWidth:!0,variant:"outlined",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.displayName,helperText:null===(t=b.displayName)||void 0===t?void 0:t.message}),Object(r.jsx)(He.Controller,{as:Fe.a,name:"password",label:"\u5bc6\u7801",required:!0,fullWidth:!0,variant:"outlined",type:"password",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.password,helperText:null===(n=b.password)||void 0===n?void 0:n.message}),Object(r.jsx)(He.Controller,{as:Fe.a,name:"email",label:"\u90ae\u7bb1",fullWidth:!0,variant:"outlined",control:j,defaultValue:"",rules:{required:!0},classes:{root:c.formItemRoot},error:!!b.email,helperText:null===(o=b.email)||void 0===o?void 0:o.message}),Object(r.jsx)(He.Controller,{as:Fe.a,name:"phone",label:"\u624b\u673a\u53f7",fullWidth:!0,variant:"outlined",control:j,defaultValue:"",classes:{root:c.formItemRoot},error:!!b.phone,helperText:null===(i=b.phone)||void 0===i?void 0:i.message}),Object(r.jsx)(ce.a,{type:"submit",variant:"contained",color:"primary",disableElevation:!0,fullWidth:!0,classes:{fullWidth:c.buttonFullWidth},disabled:x,children:"\u6ce8\u518c"}),Object(r.jsx)(ce.a,{type:"submit",variant:"contained",disableElevation:!0,fullWidth:!0,classes:{fullWidth:c.buttonFullWidth},onClick:function(){return l.push("/user/login")},children:"\u5df2\u6709\u8d26\u53f7\uff1f\u70b9\u6b64\u767b\u5f55"})]}),Object(r.jsx)(De.a,{open:k.show,onClose:function(){return T({show:!1,message:""})},autoHideDuration:3e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(r.jsx)(Ve.a,{severity:"error",children:k.message})})]})},bt=Object(le.a)((function(e){return Object(ue.a)({root:{marginTop:e.spacing(20)}})})),ft=function(){var e=bt();return Object(r.jsxs)("div",{className:e.root,children:[Object(r.jsx)(Ae.a,{children:Object(r.jsx)("title",{children:"NO WORDS -- \u6ce8\u518c"})}),Object(r.jsx)(jt,{})]})},ht=n(28),Ot=n(308),pt=n(189),vt=n.n(pt),mt=n(188),gt=n.n(mt),xt=n(305),wt=n(307),yt=n(306),kt=n(317),Tt=("".concat(window.location.origin,"/user/login"),Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GRAPHQL_HTTP_URI:"https://portrait.gwthub.com/graphql",REACT_APP_AUTH_URL:"https://portrait.gwthub.com/auth/thirdLogin"}).REACT_APP_GRAPHQL_WS_URI,"card"),Nt=n(183),St=n.n(Nt),Ct=n(182),Wt=n.n(Ct),Et=Object(le.a)((function(e){return Object(ue.a)({icon:{textAlign:"center"}})})),_t=function(e){var t=Et(),n=Object(pe.a)(!1),a=Object(M.a)(n,2),o=a[0],i=a[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:t.icon,children:o?Object(r.jsx)(Wt.a,{onClick:i}):Object(r.jsx)(St.a,{onClick:i})}),o?Object(r.jsx)(je.a,{variant:"body2",children:e.children}):null]})},It=Object(le.a)((function(e){return Object(ue.a)({card:{margin:"auto",overflow:"auto",height:"40vh",width:"75vw"}})})),Rt=function(e){var t=e.data.node,n=It(),a=Object(kt.a)({item:{type:Tt,id:t.id},collect:function(e){var n=e.getInitialClientOffset(),r=e.getClientOffset(),a=e.getItem(),o=a&&a.id===t.id;return{isDragging:!!e.isDragging(),offset:{x:o&&r&&n?(null===r||void 0===r?void 0:r.x)-(null===n||void 0===n?void 0:n.x):0,y:o&&r&&n?(null===r||void 0===r?void 0:r.y)-(null===n||void 0===n?void 0:n.y):0}}},end:function(n,r){var a=r.getInitialClientOffset(),o=r.getClientOffset(),i=r.getItem(),c=i&&i.id===t.id,s=o&&a?(null===o||void 0===o?void 0:o.x)-(null===a||void 0===a?void 0:a.x):0;c&&s>100&&e.onSlideRight&&e.onSlideRight(e.data),c&&s<-100&&e.onSlideLeft&&e.onSlideLeft(e.data)}}),o=Object(M.a)(a,2),i=o[0].offset,c=o[1];return Object(r.jsx)("div",{ref:c,style:{transform:"translate(".concat(i.x,"px, ").concat(i.y,"px)")},children:Object(r.jsxs)(xt.a,{className:n.card,children:[Object(r.jsx)(yt.a,{title:t.word}),Object(r.jsx)(wt.a,{children:Object(r.jsx)(je.a,{variant:"body2",children:t.example})}),Object(r.jsx)(wt.a,{children:Object(r.jsx)(_t,{children:t.translation})})]})})};function Lt(){var e=Object(T.a)(["\n  position: relative;\n  margin: 20px auto 30px;\n  height: 40vh;\n  width: 75vw;\n"]);return Lt=function(){return e},e}function qt(){var e=Object(T.a)(["\n  position: absolute;\n  width: 100%;\n  top: 0;\n  left: 0;\n  transform: ",";\n"]);return qt=function(){return e},e}var At=ee.a.div(qt(),(function(e){return"perspective(500px) translate3d(0,"+10*Math.min(e.index,2)+"px,"+-20*Math.min(e.index,2)+"px)"})),Ut=ee.a.div(Lt()),Pt=function(e){return Object(r.jsx)(Ut,{children:e.list.map((function(t,n){return Object(r.jsx)(At,{index:n,children:Object(r.jsx)(Rt,{data:t,onSlideLeft:e.onSlideLeft,onSlideRight:e.onSlideRight})},t.node.id)})).reverse()})},$t=Object(le.a)((function(e){return Object(ue.a)({root:{display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center",flex:1},content:{display:"flex",flexDirection:"column"},noWords:{margin:"auto",padding:e.spacing(2),textAlign:"center"},action:{display:"flex",justifyContent:"space-evenly",alignContent:"center"}})})),Dt=function(){var e=$t(),t=o.a.useState(0),n=Object(M.a)(t,2),a=n[0],i=n[1],c=Object(s.useQuery)(q,{variables:{first:4}}),l=c.data,u=c.loading,d=c.fetchMore,j=c.refetch,b=Object(s.useMutation)(lt),f=Object(M.a)(b,1)[0],p=function(){var e=Object(O.a)(h.a.mark((function e(t,n){var r,o,c,s,u,j,b,O;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n||(null===l||void 0===l||null===(r=l.allNewWords)||void 0===r||null===(o=r.edges)||void 0===o?void 0:o[a])){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,f({variables:{input:{id:u.node.id,forgottenTimes:"forgotten"===t?u.node.forgottenTimes+1:u.node.forgottenTimes,rememberTimes:"remember"===t?u.node.rememberTimes+1:u.node.rememberTimes}}});case 5:j=e.sent,(null===(c=j.data)||void 0===c||null===(s=c.updateUserWord)||void 0===s?void 0:s.success)&&(i((function(e){return e+1})),(null===(O=null===l||void 0===l||null===(b=l.allNewWords)||void 0===b?void 0:b.pageInfo)||void 0===O?void 0:O.hasNextPage)&&(h={first:1,after:O.endCursor},d({variables:h,updateQuery:function(e,t){var n=t.fetchMoreResult;if(!n||!n.allNewWords)return e;var r=n.allNewWords.edges,a=n.allNewWords.pageInfo,o=n.allNewWords.totalCount,i={allNewWords:{__typename:e.allNewWords.__typename,edges:[].concat(Object(ht.a)(e.allNewWords.edges),Object(ht.a)(r)),pageInfo:a,totalCount:o}};return r&&r.length?i:e}})));case 7:case"end":return e.stop()}var h}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j({first:4,after:void 0});case 2:i(0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{className:e.root,children:Object(r.jsx)("div",{className:e.content,children:function(){var t,n,o,i,c,s,d;return!(null===l||void 0===l||null===(t=l.allNewWords)||void 0===t||null===(n=t.edges)||void 0===n?void 0:n.length)&&u?Object(r.jsx)(Pe.a,{elevation:0,className:e.noWords,children:Object(r.jsx)(je.a,{variant:"body2",children:"Loading..."})}):0===(null===l||void 0===l||null===(o=l.allNewWords)||void 0===o?void 0:o.totalCount)?Object(r.jsx)(Pe.a,{elevation:0,className:e.noWords,children:Object(r.jsx)(je.a,{variant:"body2",children:"\u6ca1\u6709\u65b0\u7684\u5355\u8bcd\u4e86~"})}):(null===l||void 0===l||null===(i=l.allNewWords)||void 0===i||null===(c=i.edges)||void 0===c?void 0:c.length)&&(null===l||void 0===l||null===(s=l.allNewWords)||void 0===s?void 0:s.edges.length)>a?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Pt,{list:null===l||void 0===l||null===(d=l.allNewWords)||void 0===d?void 0:d.edges.slice(a,a+4),onSlideLeft:function(e){return p("forgotten",e)},onSlideRight:function(e){return p("remember",e)}}),Object(r.jsxs)("div",{className:e.action,children:[Object(r.jsx)(Ot.a,{color:"secondary","aria-label":"forgotten",onClick:function(){return p("forgotten")},children:Object(r.jsx)(gt.a,{})}),Object(r.jsx)(Ot.a,{color:"primary","aria-label":"remember",onClick:function(){return p("remember")},children:Object(r.jsx)(vt.a,{})})]})]}):Object(r.jsxs)(Pe.a,{elevation:0,className:e.noWords,children:[Object(r.jsx)(je.a,{variant:"body2",children:"\u606d\u559c\u5b8c\u6210\u6240\u6709\u5355\u8bcd"}),Object(r.jsx)(ce.a,{variant:"outlined",color:"secondary",onClick:v,children:"\u518d\u6765\u4e00\u904d"})]})}()})})},Ft=n(319),Jt=n(323),Mt=n(312),Vt=n(311),Ht=n(242),Bt=n(192),zt=n.n(Bt),Kt=n(191),Qt=n.n(Kt),Gt=n(127),Xt=n(245),Yt=n(310),Zt=n(309),en=n(190),tn=n.n(en),nn=Object(le.a)((function(e){return Object(ue.a)({root:{display:"flex",flexDirection:"column",width:"100%",height:"100%"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},content:{"& > *":{marginTop:e.spacing(2)},flex:1,margin:e.spacing(2),overflow:"auto"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})})),rn=function(e){var t=e.onManualClose,n=Object(ne.a)(e,["onManualClose"]),a=nn(),i=Object(He.useForm)({mode:"onChange"}),c=i.control,l=i.handleSubmit,u=i.errors,d=Object(s.useMutation)(ct),j=Object(M.a)(d,1)[0],b=o.a.useState(!1),f=Object(M.a)(b,2),p=f[0],v=f[1],m=function(){var e=Object(O.a)(h.a.mark((function e(n){var r,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.next=3,j({variables:{input:n}});case 3:o=e.sent,v(!1),(null===(r=o.data)||void 0===r||null===(a=r.addUserWord)||void 0===a?void 0:a.id)&&t();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return console.log("errors:",u),Object(r.jsxs)(Zt.a,Object(te.a)(Object(te.a)({},n),{},{children:[Object(r.jsxs)("form",{className:a.root,onSubmit:l(m),noValidate:!0,autoComplete:"off",children:[Object(r.jsx)(ie.a,{className:a.appBar,children:Object(r.jsxs)(de.a,{children:[Object(r.jsx)(se.a,{edge:"start",color:"inherit","aria-label":"close",onClick:function(){t()},children:Object(r.jsx)(tn.a,{})}),Object(r.jsx)(je.a,{variant:"h6",className:a.title,children:"\u6dfb\u52a0\u751f\u8bcd"}),Object(r.jsx)(ce.a,{disabled:p,autoFocus:!0,color:"inherit",type:"submit",children:"\u4fdd\u5b58"})]})}),Object(r.jsxs)("div",{className:a.content,children:[Object(r.jsx)(He.Controller,{control:c,as:Object(r.jsx)(Fe.a,{error:!!u.word,fullWidth:!0,label:"\u751f\u8bcd",placeholder:"\u8bf7\u8f93\u5165\u751f\u8bcd",variant:"outlined",helperText:Object(r.jsx)(Gt.a,{errors:u,name:"word"})}),name:"word",rules:{required:{value:!0,message:"\u5fc5\u586b"},maxLength:{value:32,message:"\u5355\u8bcd\u8fc7\u957f"}},defaultValue:""}),Object(r.jsx)(He.Controller,{control:c,as:Object(r.jsx)(Fe.a,{fullWidth:!0,label:"\u7ffb\u8bd1",placeholder:"\u8bf7\u8f93\u5165\u7ffb\u8bd1\uff08\u53ef\u4e0d\u586b\uff09",variant:"outlined",helperText:Object(r.jsx)(Gt.a,{errors:u,name:"translation"})}),name:"translation",rules:{maxLength:{value:512,message:"\u7ffb\u8bd1\u8fc7\u957f"}},multiline:!0,rows:"4",defaultValue:""}),Object(r.jsx)(He.Controller,{control:c,as:Object(r.jsx)(Fe.a,{fullWidth:!0,label:"\u4f8b\u53e5",placeholder:"\u8bf7\u8f93\u5165\u4f8b\u53e5\uff08\u53ef\u4e0d\u586b\uff09",variant:"outlined",helperText:Object(r.jsx)(Gt.a,{errors:u,name:"example"})}),name:"example",rules:{maxLength:{value:512,message:"\u4f8b\u53e5\u8fc7\u957f"}},multiline:!0,rows:"4",defaultValue:""})]})]}),Object(r.jsx)(Xt.a,{className:a.backdrop,open:p,children:Object(r.jsx)(Yt.a,{color:"inherit"})})]}))},an=o.a.forwardRef((function(e,t){return Object(r.jsx)(Ht.a,Object(te.a)({direction:"up",ref:t},e))})),on=Object(le.a)((function(e){return Object(ue.a)({root:{width:"100%",backgroundColor:e.palette.background.paper,paddingBottom:e.spacing(8),overflow:"auto"},actions:{position:"fixed",bottom:e.spacing(10),right:e.spacing(3)}})})),cn=function(){var e,t,n=on(),a=o.a.useState(!1),i=Object(M.a)(a,2),c=i[0],l=i[1],u=Object(s.useQuery)(A,{variables:{first:20}}).data,d=function(){l(!1)};return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ve.a,{className:n.root,children:null===u||void 0===u||null===(e=u.allUserWords)||void 0===e||null===(t=e.edges)||void 0===t?void 0:t.map((function(e){return Object(r.jsxs)(Jt.a,{children:[Object(r.jsx)(Vt.a,{expandIcon:Object(r.jsx)(Qt.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(r.jsxs)(me.a,{children:[Object(r.jsx)(ge.a,{children:Object(r.jsx)(Ft.a,{edge:"start",tabIndex:-1,disableRipple:!0,onClick:function(e){return e.stopPropagation()}})}),Object(r.jsx)(xe.a,{children:Object(r.jsx)(je.a,{children:e.node.word})})]})}),Object(r.jsxs)(Mt.a,{children:[Object(r.jsx)(je.a,{children:e.node.example}),Object(r.jsx)(je.a,{children:e.node.translation})]})]},e.node.id)}))}),Object(r.jsx)(Ot.a,{className:n.actions,color:"primary","aria-label":"remember",onClick:function(){l(!0)},children:Object(r.jsx)(zt.a,{})}),Object(r.jsx)(rn,{open:c,fullScreen:!0,onClose:d,onManualClose:d,TransitionComponent:an})]})};function sn(){var e=Object(T.a)(["\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  width: 100%;\n  height: 100%;\n"]);return sn=function(){return e},e}function ln(){var e=Object(T.a)(["\n  display: flex;\n  flex: 1;\n  overflow: auto;\n"]);return ln=function(){return e},e}var un=ee.a.div(ln()),dn=ee.a.div(sn()),jn=function(){return Object(r.jsx)(Y.a,{children:Object(r.jsxs)(Z.d,{children:[Object(r.jsx)(Z.b,{path:"/user/login",exact:!0,component:rt}),Object(r.jsx)(Z.b,{path:"/user/signup",component:ft}),Object(r.jsx)(ae,{path:"/",children:Object(r.jsxs)(dn,{children:[Object(r.jsx)(Ce,{}),Object(r.jsxs)(Z.b,{path:"/words",children:[Object(r.jsx)(un,{children:Object(r.jsxs)(Z.d,{children:[Object(r.jsx)(Z.b,{path:"/words/memorize",component:Dt}),Object(r.jsx)(Z.b,{path:"/words/my-words",component:cn}),Object(r.jsx)(Z.b,{path:"/words/statistics",children:"statistics"}),Object(r.jsx)(Z.a,{to:"/words/memorize"})]})}),Object(r.jsx)(qe,{})]})]})})]})})},bn=n(193),fn=Object(bn.a)({palette:{secondary:{main:"#127bc4",light:"rgb(65, 149, 207)",dark:"rgb(12, 86, 137)",contrastText:"#fff"},type:"dark",background:{default:"#121212"},primary:{main:"#d63947",light:"rgb(222, 96, 107)",dark:"rgb(149, 39, 49)",contrastText:"#fff"}}}),hn=Object(bn.a)({palette:{secondary:{main:"#127bc4",light:"rgb(65, 149, 207)",dark:"rgb(12, 86, 137)",contrastText:"#fff"},type:"light",background:{default:"#fff"},primary:{main:"#d63947",light:"rgb(222, 96, 107)",dark:"rgb(149, 39, 49)",contrastText:"#fff"}}});var On=function(){var e=X();return console.log("thememod",e),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(s.ApolloProvider,{client:F,children:Object(r.jsx)(j.a,{backend:b.a,children:Object(r.jsx)(l.a,{theme:"dark"===e?fn:hn,children:Object(r.jsxs)(d.a,{children:[Object(r.jsx)(u.a,{}),Object(r.jsx)(jn,{}),Object(r.jsx)(J,{})]})})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(On,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[240,1,2]]]);
//# sourceMappingURL=main.9a7ddd52.chunk.js.map